
// You can write more code here

/* START OF COMPILED CODE */

class Level extends Phaser.Scene {

	constructor() {
		super("Level");

		/* START-USER-CTR-CODE */
		// Write your code here.
		/* END-USER-CTR-CODE */
	}

	/** @returns {void} */
	editorCreate() {

		// p_0_0
		const p_0_0 = new PlacePoint(this, 939, 1543);
		this.add.existing(p_0_0);

		// p_0_1
		const p_0_1 = new PlacePoint(this, 805, 1543);
		this.add.existing(p_0_1);

		// p_0_2
		const p_0_2 = new PlacePoint(this, 671, 1543);
		this.add.existing(p_0_2);

		// p_0_3
		const p_0_3 = new PlacePoint(this, 534, 1543);
		this.add.existing(p_0_3);

		// p_0_4
		const p_0_4 = new PlacePoint(this, 400, 1543);
		this.add.existing(p_0_4);

		// p_0_5
		const p_0_5 = new PlacePoint(this, 264, 1543);
		this.add.existing(p_0_5);

		// p_0_6
		const p_0_6 = new PlacePoint(this, 130, 1543);
		this.add.existing(p_0_6);

		// p_1_0
		const p_1_0 = new PlacePoint(this, 939, 1406);
		this.add.existing(p_1_0);

		// p_1_1
		const p_1_1 = new PlacePoint(this, 805, 1406);
		this.add.existing(p_1_1);

		// p_1_2
		const p_1_2 = new PlacePoint(this, 671, 1406);
		this.add.existing(p_1_2);

		// p_1_3
		const p_1_3 = new PlacePoint(this, 534, 1406);
		this.add.existing(p_1_3);

		// p_1_4
		const p_1_4 = new PlacePoint(this, 400, 1406);
		this.add.existing(p_1_4);

		// p_1_5
		const p_1_5 = new PlacePoint(this, 264, 1406);
		this.add.existing(p_1_5);

		// p_1_6
		const p_1_6 = new PlacePoint(this, 130, 1406);
		this.add.existing(p_1_6);

		// p_2_0
		const p_2_0 = new PlacePoint(this, 939, 1269);
		this.add.existing(p_2_0);

		// p_2_1
		const p_2_1 = new PlacePoint(this, 805, 1269);
		this.add.existing(p_2_1);

		// p_2_2
		const p_2_2 = new PlacePoint(this, 671, 1269);
		this.add.existing(p_2_2);

		// p_2_3
		const p_2_3 = new PlacePoint(this, 534, 1269);
		this.add.existing(p_2_3);

		// p_2_4
		const p_2_4 = new PlacePoint(this, 400, 1269);
		this.add.existing(p_2_4);

		// p_2_5
		const p_2_5 = new PlacePoint(this, 264, 1269);
		this.add.existing(p_2_5);

		// p_2_6
		const p_2_6 = new PlacePoint(this, 130, 1269);
		this.add.existing(p_2_6);

		// p_3_0
		const p_3_0 = new PlacePoint(this, 939, 1130);
		this.add.existing(p_3_0);

		// p_3_1
		const p_3_1 = new PlacePoint(this, 805, 1130);
		this.add.existing(p_3_1);

		// p_3_2
		const p_3_2 = new PlacePoint(this, 671, 1130);
		this.add.existing(p_3_2);

		// p_3_3
		const p_3_3 = new PlacePoint(this, 534, 1130);
		this.add.existing(p_3_3);

		// p_3_4
		const p_3_4 = new PlacePoint(this, 400, 1130);
		this.add.existing(p_3_4);

		// p_3_5
		const p_3_5 = new PlacePoint(this, 264, 1130);
		this.add.existing(p_3_5);

		// p_3_6
		const p_3_6 = new PlacePoint(this, 130, 1130);
		this.add.existing(p_3_6);

		// p_4_0
		const p_4_0 = new PlacePoint(this, 939, 991);
		this.add.existing(p_4_0);

		// p_4_1
		const p_4_1 = new PlacePoint(this, 805, 991);
		this.add.existing(p_4_1);

		// p_4_2
		const p_4_2 = new PlacePoint(this, 671, 991);
		this.add.existing(p_4_2);

		// p_4_3
		const p_4_3 = new PlacePoint(this, 534, 991);
		this.add.existing(p_4_3);

		// p_4_4
		const p_4_4 = new PlacePoint(this, 400, 991);
		this.add.existing(p_4_4);

		// p_4_5
		const p_4_5 = new PlacePoint(this, 264, 991);
		this.add.existing(p_4_5);

		// p_4_6
		const p_4_6 = new PlacePoint(this, 130, 991);
		this.add.existing(p_4_6);

		// p_5_0
		const p_5_0 = new PlacePoint(this, 939, 853);
		this.add.existing(p_5_0);

		// p_5_1
		const p_5_1 = new PlacePoint(this, 805, 853);
		this.add.existing(p_5_1);

		// p_5_2
		const p_5_2 = new PlacePoint(this, 671, 853);
		this.add.existing(p_5_2);

		// p_5_3
		const p_5_3 = new PlacePoint(this, 534, 853);
		this.add.existing(p_5_3);

		// p_5_4
		const p_5_4 = new PlacePoint(this, 400, 853);
		this.add.existing(p_5_4);

		// p_5_5
		const p_5_5 = new PlacePoint(this, 264, 853);
		this.add.existing(p_5_5);

		// p_5_6
		const p_5_6 = new PlacePoint(this, 130, 853);
		this.add.existing(p_5_6);

		// p_6_0
		const p_6_0 = new PlacePoint(this, 939, 715);
		this.add.existing(p_6_0);

		// p_6_1
		const p_6_1 = new PlacePoint(this, 805, 715);
		this.add.existing(p_6_1);

		// p_6_2
		const p_6_2 = new PlacePoint(this, 671, 715);
		this.add.existing(p_6_2);

		// p_6_3
		const p_6_3 = new PlacePoint(this, 534, 715);
		this.add.existing(p_6_3);

		// p_6_4
		const p_6_4 = new PlacePoint(this, 400, 715);
		this.add.existing(p_6_4);

		// p_6_5
		const p_6_5 = new PlacePoint(this, 264, 715);
		this.add.existing(p_6_5);

		// p_6_6
		const p_6_6 = new PlacePoint(this, 130, 715);
		this.add.existing(p_6_6);

		// background
		const background = this.add.image(549, 965, "Background");
		background.scaleX = 1.05;
		background.scaleY = 1.05;

		// informer
		const informer = this.add.text(540, 1808, "", {});
		informer.setOrigin(0.5, 0.5);
		informer.setStyle({ "align": "center", "fontSize": "50px", "fontStyle": "bold" });

		// board
		this.add.image(540, 1129, "Board");

		// pl
		const pl = new UserProfile(this, 132, 232);
		this.add.existing(pl);

		// pr
		const pr = new UserProfile(this, 948, 232);
		this.add.existing(pr);

		// popup
		const popup = this.add.container(540, 1103);
		popup.visible = false;

		// popup_img
		const popup_img = this.add.image(0, 0, "popup");
		popup_img.scaleX = 2.1;
		popup_img.scaleY = 4;
		popup.add(popup_img);

		// winner_tag
		const winner_tag = this.add.text(0, 10, "", {});
		winner_tag.setOrigin(0.5, 0.5);
		winner_tag.text = "Won";
		winner_tag.setStyle({ "align": "center", "fontSize": "150px", "fontStyle": "bold" });
		popup.add(winner_tag);

		// winner_name_txt
		const winner_name_txt = this.add.text(0, -220, "", {});
		winner_name_txt.setOrigin(0.5, 0.5);
		winner_name_txt.text = "Sejpalsinh";
		winner_name_txt.setStyle({ "align": "center", "fontSize": "100px", "fontStyle": "bold" });
		popup.add(winner_name_txt);

		// exit_btn
		const exit_btn = this.add.image(-166, 297, "exit");
		exit_btn.scaleX = 0.3;
		exit_btn.scaleY = 0.3;
		popup.add(exit_btn);

		// restart_btn
		const restart_btn = this.add.image(183, 297, "restart");
		restart_btn.scaleX = 0.3;
		restart_btn.scaleY = 0.3;
		popup.add(restart_btn);

		this.p_0_0 = p_0_0;
		this.p_0_1 = p_0_1;
		this.p_0_2 = p_0_2;
		this.p_0_3 = p_0_3;
		this.p_0_4 = p_0_4;
		this.p_0_5 = p_0_5;
		this.p_0_6 = p_0_6;
		this.p_1_0 = p_1_0;
		this.p_1_1 = p_1_1;
		this.p_1_2 = p_1_2;
		this.p_1_3 = p_1_3;
		this.p_1_4 = p_1_4;
		this.p_1_5 = p_1_5;
		this.p_1_6 = p_1_6;
		this.p_2_0 = p_2_0;
		this.p_2_1 = p_2_1;
		this.p_2_2 = p_2_2;
		this.p_2_3 = p_2_3;
		this.p_2_4 = p_2_4;
		this.p_2_5 = p_2_5;
		this.p_2_6 = p_2_6;
		this.p_3_0 = p_3_0;
		this.p_3_1 = p_3_1;
		this.p_3_2 = p_3_2;
		this.p_3_3 = p_3_3;
		this.p_3_4 = p_3_4;
		this.p_3_5 = p_3_5;
		this.p_3_6 = p_3_6;
		this.p_4_0 = p_4_0;
		this.p_4_1 = p_4_1;
		this.p_4_2 = p_4_2;
		this.p_4_3 = p_4_3;
		this.p_4_4 = p_4_4;
		this.p_4_5 = p_4_5;
		this.p_4_6 = p_4_6;
		this.p_5_0 = p_5_0;
		this.p_5_1 = p_5_1;
		this.p_5_2 = p_5_2;
		this.p_5_3 = p_5_3;
		this.p_5_4 = p_5_4;
		this.p_5_5 = p_5_5;
		this.p_5_6 = p_5_6;
		this.p_6_0 = p_6_0;
		this.p_6_1 = p_6_1;
		this.p_6_2 = p_6_2;
		this.p_6_3 = p_6_3;
		this.p_6_4 = p_6_4;
		this.p_6_5 = p_6_5;
		this.p_6_6 = p_6_6;
		this.informer = informer;
		this.pl = pl;
		this.pr = pr;
		this.popup = popup;
		this.winner_tag = winner_tag;
		this.winner_name_txt = winner_name_txt;
		this.exit_btn = exit_btn;
		this.restart_btn = restart_btn;

		this.events.emit("scene-awake");
	}

	/** @type {PlacePoint} */
	p_0_0;
	/** @type {PlacePoint} */
	p_0_1;
	/** @type {PlacePoint} */
	p_0_2;
	/** @type {PlacePoint} */
	p_0_3;
	/** @type {PlacePoint} */
	p_0_4;
	/** @type {PlacePoint} */
	p_0_5;
	/** @type {PlacePoint} */
	p_0_6;
	/** @type {PlacePoint} */
	p_1_0;
	/** @type {PlacePoint} */
	p_1_1;
	/** @type {PlacePoint} */
	p_1_2;
	/** @type {PlacePoint} */
	p_1_3;
	/** @type {PlacePoint} */
	p_1_4;
	/** @type {PlacePoint} */
	p_1_5;
	/** @type {PlacePoint} */
	p_1_6;
	/** @type {PlacePoint} */
	p_2_0;
	/** @type {PlacePoint} */
	p_2_1;
	/** @type {PlacePoint} */
	p_2_2;
	/** @type {PlacePoint} */
	p_2_3;
	/** @type {PlacePoint} */
	p_2_4;
	/** @type {PlacePoint} */
	p_2_5;
	/** @type {PlacePoint} */
	p_2_6;
	/** @type {PlacePoint} */
	p_3_0;
	/** @type {PlacePoint} */
	p_3_1;
	/** @type {PlacePoint} */
	p_3_2;
	/** @type {PlacePoint} */
	p_3_3;
	/** @type {PlacePoint} */
	p_3_4;
	/** @type {PlacePoint} */
	p_3_5;
	/** @type {PlacePoint} */
	p_3_6;
	/** @type {PlacePoint} */
	p_4_0;
	/** @type {PlacePoint} */
	p_4_1;
	/** @type {PlacePoint} */
	p_4_2;
	/** @type {PlacePoint} */
	p_4_3;
	/** @type {PlacePoint} */
	p_4_4;
	/** @type {PlacePoint} */
	p_4_5;
	/** @type {PlacePoint} */
	p_4_6;
	/** @type {PlacePoint} */
	p_5_0;
	/** @type {PlacePoint} */
	p_5_1;
	/** @type {PlacePoint} */
	p_5_2;
	/** @type {PlacePoint} */
	p_5_3;
	/** @type {PlacePoint} */
	p_5_4;
	/** @type {PlacePoint} */
	p_5_5;
	/** @type {PlacePoint} */
	p_5_6;
	/** @type {PlacePoint} */
	p_6_0;
	/** @type {PlacePoint} */
	p_6_1;
	/** @type {PlacePoint} */
	p_6_2;
	/** @type {PlacePoint} */
	p_6_3;
	/** @type {PlacePoint} */
	p_6_4;
	/** @type {PlacePoint} */
	p_6_5;
	/** @type {PlacePoint} */
	p_6_6;
	/** @type {Phaser.GameObjects.Text} */
	informer;
	/** @type {UserProfile} */
	pl;
	/** @type {UserProfile} */
	pr;
	/** @type {Phaser.GameObjects.Container} */
	popup;
	/** @type {Phaser.GameObjects.Text} */
	winner_tag;
	/** @type {Phaser.GameObjects.Text} */
	winner_name_txt;
	/** @type {Phaser.GameObjects.Image} */
	exit_btn;
	/** @type {Phaser.GameObjects.Image} */
	restart_btn;

	/* START-USER-CODE */

	// Write more your code here

	create() {
		this.editorCreate();
		this.pl.setPlayerUI(false, "Harsh");
		this.pr.setPlayerUI(true, "Sejpalsinh");

		this.aPlayers = new Array(2);
		this.aPlayers[0] = this.pl;
		this.aPlayers[1] = this.pr;

		this.aPosPoints = new Array(7);
		this.aPosPoints[0] = new Array(7);
		this.aPosPoints[1] = new Array(7);
		this.aPosPoints[2] = new Array(7);
		this.aPosPoints[3] = new Array(7);
		this.aPosPoints[4] = new Array(7);
		this.aPosPoints[5] = new Array(7);
		this.aPosPoints[6] = new Array(7);

		//Bottom 0th Row
		this.aPosPoints[0][0] = this.p_0_0;
		this.aPosPoints[0][1] = this.p_0_1;
		this.aPosPoints[0][2] = this.p_0_2;
		this.aPosPoints[0][3] = this.p_0_3;
		this.aPosPoints[0][4] = this.p_0_4;
		this.aPosPoints[0][5] = this.p_0_5;
		this.aPosPoints[0][6] = this.p_0_6;

		//Bottom 1st Row
		this.aPosPoints[1][0] = this.p_1_0;
		this.aPosPoints[1][1] = this.p_1_1;
		this.aPosPoints[1][2] = this.p_1_2;
		this.aPosPoints[1][3] = this.p_1_3;
		this.aPosPoints[1][4] = this.p_1_4;
		this.aPosPoints[1][5] = this.p_1_5;
		this.aPosPoints[1][6] = this.p_1_6;

		//Bottom 2nd Row
		this.aPosPoints[2][0] = this.p_2_0;
		this.aPosPoints[2][1] = this.p_2_1;
		this.aPosPoints[2][2] = this.p_2_2;
		this.aPosPoints[2][3] = this.p_2_3;
		this.aPosPoints[2][4] = this.p_2_4;
		this.aPosPoints[2][5] = this.p_2_5;
		this.aPosPoints[2][6] = this.p_2_6;

		//Bottom 3rd Row
		this.aPosPoints[3][0] = this.p_3_0;
		this.aPosPoints[3][1] = this.p_3_1;
		this.aPosPoints[3][2] = this.p_3_2;
		this.aPosPoints[3][3] = this.p_3_3;
		this.aPosPoints[3][4] = this.p_3_4;
		this.aPosPoints[3][5] = this.p_3_5;
		this.aPosPoints[3][6] = this.p_3_6;

		//Bottom 4th Row
		this.aPosPoints[4][0] = this.p_4_0;
		this.aPosPoints[4][1] = this.p_4_1;
		this.aPosPoints[4][2] = this.p_4_2;
		this.aPosPoints[4][3] = this.p_4_3;
		this.aPosPoints[4][4] = this.p_4_4;
		this.aPosPoints[4][5] = this.p_4_5;
		this.aPosPoints[4][6] = this.p_4_6;

		//Bottom 5th Row
		this.aPosPoints[5][0] = this.p_5_0;
		this.aPosPoints[5][1] = this.p_5_1;
		this.aPosPoints[5][2] = this.p_5_2;
		this.aPosPoints[5][3] = this.p_5_3;
		this.aPosPoints[5][4] = this.p_5_4;
		this.aPosPoints[5][5] = this.p_5_5;
		this.aPosPoints[5][6] = this.p_5_6;

		//Bottom 6th Row
		this.aPosPoints[6][0] = this.p_6_0;
		this.aPosPoints[6][1] = this.p_6_1;
		this.aPosPoints[6][2] = this.p_6_2;
		this.aPosPoints[6][3] = this.p_6_3;
		this.aPosPoints[6][4] = this.p_6_4;
		this.aPosPoints[6][5] = this.p_6_5;
		this.aPosPoints[6][6] = this.p_6_6;

		this.oGridManager = new GridManager(this.aPosPoints);
		this.nPlayerTurnNo = 1;

		this.restart_btn.setInteractive().on('pointerdown', this.restartGame, this);

		this.exit_btn.setInteractive().on('pointerdown', function () {
			window.close();
		}, this);

		
		this.setInfoMsg("Red is "+this.aPlayers[0].sPlayerName);
		this.generateCoin();

		console.log("UI Loaded!");
	}

	generateCoin(){
		var coin;
		if(this.nPlayerTurnNo == 1) { coin = new Coin(this, 537, 533, "Red"); }
		else{ coin = new Coin(this, 537, 533, "Yellow"); }
		this.add.existing(coin);
		this.setInfoMsg(this.aPlayers[this.nPlayerTurnNo-1].sPlayerName+"\'s Turn");
	}

	checkResult(nRowNum,nColNum){
		if(GridManager.isWon(nRowNum,nColNum,this.nPlayerTurnNo)){
			this.clearPanel();
			this.setInfoMsg(this.aPlayers[this.nPlayerTurnNo-1].sPlayerName);
			this.winner_name_txt.text = this.aPlayers[this.nPlayerTurnNo-1].sPlayerName;
			this.popup.visible = true;
		}
		else{
			this.changePlayerTurn();
		}
	}

	changePlayerTurn(){
		if(this.nPlayerTurnNo == 1)this.nPlayerTurnNo++;
		else{ this.nPlayerTurnNo--; }
		this.generateCoin();
	}

	setInfoMsg(sMsg){
		this.informer.visible = true;
		this.informer.setText(sMsg);
	}

	setInfoMsgTimer(sMsg, nTime) {
		this.setInfoMsg(sMsg);
		var self = this;
		setTimeout(function () {
			if(self.informer.text==sMsg){ self.informer.visible = false; }
		}, nTime*1000);
	}


	restartGame(){
		this.clearPanel();
		this.popup.visible = false;
		this.generateCoin();
	}

	clearPanel()
	{
		for(var i=0; i<7; i++){
			for(var j=0; j<7; j++){
				this.aPosPoints[i][j].resetPlace();
			}
		}
	}
	/* END-USER-CODE */
}

/* END OF COMPILED CODE */

// You can write more code here
